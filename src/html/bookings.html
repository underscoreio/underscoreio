---
layout      : page
pageClass   : landing
---

{% raw %}
<?php

// CONFIGURATION --------------------------------

$courseOptions = Array(
  "course-core-scala"          => "Core Scala",
  "course-core-play"           => "Core Play",
  "course-essential-scalaz"    => "Essential Scalaz",
  "course-essential-shapeless" => "Essential Shapeless",
  "course-essential-macros"    => "Essential Macros",
  "course-other"               => "Other (please specify)"
);

$peopleOptions = Array(
  "1-5-people"   => "1-5 people",
  "6-10-people"  => "6-10 people",
  "gt-10-people" => "> 10 people"
);

$bookingEmail = 'Underscore Bookings <bookings@underscoreconsulting.com>';

// ----------------------------------------------

function requestString($key, $default) {
  if(isset($_POST[$key]) && strlen(trim($_POST[$key])) > 0) {
    return trim($_POST[$key]);
  } else {
    return $default;
  }
}

function requestLookup($key, $options, $default) {
  if(isset($_POST[$key]) && isset($options[$_POST[$key]])) {
    return $options[$_POST[$key]];
  } else {
    return $default;
  }
}

if($_SERVER['REQUEST_METHOD'] == 'POST'):
  $name     = requestString('name',   'Not specified');
  $email    = requestString('email',  null);
  $phone    = requestString('phone', 'Not specified');
  $location = requestString('location', 'Not specified');
  $notes    = requestString('notes', 'None specified');
  $people   = requestLookup('people', $peopleOptions, 'Not specified');

  $courses  = Array();
  foreach($courseOptions as $courseId => $courseName) {
    if(isset($_POST["course-$courseId"])) {
      $courses[] = $courseName;
    }
  }
  $allCourses = count($courses) > 0 ? implode("\n - ", $courses) : 'None specified';

  $emailTo      = $bookingEmail;
  $emailSubject = "Booking request on underscore.io";
  $emailDate    = gmdate(DATE_RFC822);

  $emailBody    = <<<ENDEMAIL
A booking request was submitted on underscore.io:

Name: $name
Email: $email
Phone: $phone

Courses:
 - $allCourses

People: $people
Location: $location

Additional notes:
$notes

--
Underscore Bookings Robot
http://underscore.io
ENDEMAIL;

  $emailLength  = strlen($emailBody);
  $emailExtras  = "From: $name <$email>\r\nDate: $emailDate\r\nContent-Length: $emailLength";

  if(!$email):
    echo '<div class="alert alert-danger">Please specify a valid email address.</div>';
  elseif(mail($emailTo, $emailSubject, $emailBody, $emailExtras)):
    echo '<div class="alert alert-success">Thank you for your enquiry. Our training coordinator will be in touch shortly.</div>';
  else:
    echo '<div class="alert alert-danger">There was an error submitting your booking enquiry. Please get in touch by phone or email.</div>';
  endif;
endif;

// ----------------------------------------------

?>
{% endraw %}

<h1>Enquire about face-to-face training</h1>

<p>
  Use the form below to enquire about on-site face-to-face training for your development team, or contact us by email (<a href="mailto:hello@underscore.io">hello@underscore.io</a>) or phone (<a href="tel:+44203095 5332">+44 (0)20 3095 5332</a>).
</p>

<p>
You can choose from our standard course offerings, or we can create a curriculum customised to your team's unique training needs. We believe learning should never stop, so all of our on-site training is supported with free ongoing access to our online material.
</p>

<form id="bookings-form" method="post">
  <div class="form-group">
    <label>Your name</label>
    <input type="text" class="form-control" name="name" placeholder="Leonardo da Vinci">
  </div>

  <div class="form-group">
    <label>Your email address</label>
    <input type="email" class="form-control" name="email" placeholder="leonardo@davinci.com">
  </div>

  <div class="form-group">
    <label>Your phone number (optional)</label>
    <input type="phone" class="form-control" name="phone" placeholder="+44 123 456 7890">
  </div>

  <div class="form-group">
    <label>Which course(s) are you interested in?</label>

{% raw %}
<?php foreach($courseOptions as $courseId => $courseLabel): ?>
    <div class="checkbox">
      <label>
        <input type="checkbox" name="course-<?= $courseId ?>">
        <?= $courseLabel ?>
      </label>
    </div>
<?php endforeach; ?>
{% endraw %}
  </div>

  <div class="form-group">
    <label>How many people are on your team?</label>

{% raw %}
<?php foreach($peopleOptions as $peopleId => $peopleLabel): ?>
    <div class="radio">
      <label>
        <input type="radio" name="people" value="<?= $peopleId ?>">
        <?= $peopleLabel ?>
      </label>
    </div>
<?php endforeach; ?>
{% endraw %}
  </div>

  <div class="form-group">
    <label>Where are you located?</label>

    <input type="text" class="form-control" name="location" placeholder="London, UK">

    <p class="help-block">
      We have trainers in multiple countries and deliver
      on-site training internationally.
    </p>
  </div>

  <div class="form-group">
    <label>Is there anything else we should know about your training needs?</label>

    <textarea class="form-control" name="notes" rows="5"></textarea>
  </div>

  <button type="submit" class="btn btn-success">Submit Booking</button>
</form>
